<!-- scripts.html -->

<!-- Smooth scroll via Lenis (desktop) -->
<script>
(function () {
  function initLenis() {
    if (window.innerWidth > 768 && window.Lenis) {
      const lenis = new Lenis({
        duration: 1.2,
        easing: t => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
        smooth: true,
        direction: 'vertical',
        gestureDirection: 'vertical',
        smoothTouch: false,
        touchMultiplier: 1.5,
      });

      // expõe globalmente para o código de âncoras
      window.__lenis = lenis;

      function raf(time) {
        lenis.raf(time);
        requestAnimationFrame(raf);
      }
      requestAnimationFrame(raf);
    }
  }

  if (document.readyState === "complete" || document.readyState === "interactive") {
    initLenis();
  } else {
    document.addEventListener("DOMContentLoaded", initLenis);
  }
})();
</script>

<!-- Âncoras suaves para <a data-smooth href="#..."> -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const links = document.querySelectorAll('a[data-smooth][href^="#"]');

  links.forEach(anchor => {
    anchor.addEventListener("click", function (e) {
      const targetId = this.getAttribute("href").substring(1);
      const target = document.getElementById(targetId);
      if (!target) return;

      e.preventDefault();

      // Se Lenis estiver ativo (desktop), usa; senão, faz tween manual (mobile)
      if (window.__lenis) {
        window.__lenis.scrollTo(target, {
          offset: 0,
          duration: 0.9,
          easing: t => (t < 0.5 ? 8*t*t*t*t : 1 - Math.pow(-2*t + 2, 4)/2)
        });
        return;
      }

      const start = window.scrollY;
      const end = window.scrollY + target.getBoundingClientRect().top;
      const duration = 900;
      let startTime = null;

      function easeInOutQuart(t) {
        return t < 0.5 ? 8 * t * t * t * t : 1 - Math.pow(-2 * t + 2, 4) / 2;
      }

      function animateScroll(timestamp) {
        if (!startTime) startTime = timestamp;
        const elapsed = timestamp - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const eased = easeInOutQuart(progress);
        window.scrollTo(0, start + (end - start) * eased);
        if (progress < 1) requestAnimationFrame(animateScroll);
      }

      requestAnimationFrame(animateScroll);
    });
  });
});
</script>
